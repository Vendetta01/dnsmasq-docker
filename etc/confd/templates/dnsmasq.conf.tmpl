# dnsmasq.conf generated by confd at
# {{datetime}}


# set upstream dns servers
{{- range gets "/conf/dnsmasq/servers/*"}}
server={{.Value}}
{{- end}}


# explicitly define host-ip mappings
{{- range gets "/conf/dnsmasq/addresses/*"}}
address={{.Value}}
{{- end}}


# uncomment to not use hosts nameserver
{{if exists "/conf/dnsmasq/no_resolv"}}
  {{- if getv "/conf/dnsmasq/no_resolv" | parseBool}}
    {{- "no-resolv"}}
  {{- else}}
    {{- "#no-resolv"}}
  {{- end}}
{{- else}}
  {{- "#no-resolv"}}
{{- end}}


# uncomment to log all dns queries
{{if exists "/conf/dnsmasq/log_queries"}}
  {{- if getv "/conf/dnsmasq/log_queries" | parseBool}}
    {{- "log-queries"}}
  {{- else}}
    {{- "#log-queries"}}
  {{- end}}
{{- else}}
  {{- "#log-queries"}}
{{- end}}


# advanced config section. Caution, all key-value-pairs in
# /conf/dnsmasq/advanced_config/* are written to config as
# {{.Key}}={{.Value}} or
# {{.Key}} if {{.Value}} is empty
# config is not guaranteed to be valid if you use this option
{{range ls "/conf/dnsmasq/advanced_config"}}
  {{- .}}
  {{- $key := print "/conf/dnsmasq/advanced_config/" .}}
  {{- $val := getv $key}}
  {{- if $val}}
    {{- print "=" $val}}
  {{- end}}
{{end}}


# Set maximum number of forwarded DNS queries
#dns-forward-max=150
{{if exists "/conf/dnsmasq/dns_forward_max"}}
dns-forward-max={{- getv "/conf/dnsmasq/dns_forward_max"}}
{{- end}}

